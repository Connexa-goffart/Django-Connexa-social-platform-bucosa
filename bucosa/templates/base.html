{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

    <script src="{% static 'theme-toggle.js' %}"></script>
    <script src="{% static 'pwa-install.js' %}"></script>
    <script src="{% static 'notifications.js' %}"></script>
    <script src="{% static 'firebase-push.js' %}"></script>

    <!-- Use compat versions for Firebase -->
    <script src="https://www.gstatic.com/firebasejs/10.11.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.11.0/firebase-messaging-compat.js"></script>
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <link rel="manifest" href="{% static 'manifest.json' %}">
    <meta name="theme-color" content="#22223b">
    {% block extra_head %}{% endblock %}
    <script>
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', function() {
          navigator.serviceWorker.register('{% static "service-worker.js" %}');
          navigator.serviceWorker.register('{% static "firebase-messaging-sw.js" %}');
        });
      }
    </script>
</head>
<body class="bg-white min-h-screen transition-colors duration-300 text-black" id="body-root">

    <!-- PWA Install Button -->
    <button id="pwa-install-btn" style="display:none;position:fixed;bottom:24px;right:24px;z-index:1000;background:#1976d2;color:#fff;padding:12px 24px;border:none;border-radius:8px;box-shadow:0 2px 8px rgba(0,0,0,0.2);font-size:16px;cursor:pointer;">Install Bucosa App</button>
  
    <div class="flex min-h-screen">
        <nav class="bg-black w-20 md:w-56 flex flex-col py-8 px-2 md:px-4 items-center md:items-start">
            <ul class="space-y-6 w-full">
                <li>
                  <a href="{% url 'activities:home'  %}" class="flex items-center gap-3 px-3 py-3 rounded-full hover:bg-gray-900 transition text-white font-semibold text-lg w-full {% if request.resolver_match.url_name == 'home' %}bg-gray-900{% endif %}">
                    <span class="material-icons">home</span>
                    <span class="hidden md:inline">Home</span>
                  </a>
                </li>
                <li>
                  <a href="{% url 'users:search_users' %}" class="flex items-center gap-3 px-3 py-3 rounded-full hover:bg-gray-900 transition text-white font-semibold text-lg w-full {% if request.resolver_match.url_name == 'search_users' %}bg-gray-900{% endif %}">
                    <span class="material-icons">explore</span>
                    <span class="hidden md:inline">Explore</span>
                  </a>
                </li>
                <li>
                  <a href="{% url 'users:private_messages' %}" class="flex items-center gap-3 px-3 py-3 rounded-full hover:bg-gray-900 transition text-white font-semibold text-lg w-full {% if request.resolver_match.url_name == 'private_messages' %}bg-gray-900{% endif %}">
                    <span class="material-icons">mail</span>
                    <span class="hidden md:inline">Messages</span>
                  </a>
                </li>
                <li>
                  <a href="{% url 'users:profile' user.id %}" class="flex items-center gap-3 px-3 py-3 rounded-full hover:bg-gray-900 transition text-white font-semibold text-lg w-full {% if request.resolver_match.url_name == 'profile' %}bg-gray-900{% endif %}">
                    <span class="material-icons">person</span>
                    <span class="hidden md:inline">Profile</span>
                  </a>
                </li>
                <li>
                  <a href="{% url 'fellowship_detail' 1 %}" class="flex items-center gap-3 px-3 py-3 rounded-full hover:bg-gray-900 transition text-white font-semibold text-lg w-full {% if request.resolver_match.url_name == 'fellowship_detail' %}bg-gray-900{% endif %}">
                    <span class="material-symbols-outlined">church</span>
                    <span class="hidden md:inline">Fellowship</span>
                  </a>
                </li>
                 <li>
                  <a href="{% url 'bucosa_main' %}" class="flex items-center gap-3 px-3 py-3 rounded-full hover:bg-gray-900 transition text-white font-semibold text-lg w-full {% if request.resolver_match.url_name == 'fellowship_detail' %}bg-gray-900{% endif %}">
                    <span class="material-icons">groups</span>
                    <span class="hidden md:inline">Bucosa</span>
                  </a>
                </li>
                <li>
                  <a href="{% url 'users:logout' %}" class="flex items-center gap-3 px-3 py-3 rounded-full hover:bg-gray-900 transition text-white font-semibold text-lg w-full">
                    <span class="material-icons">logout</span>
                    <span class="hidden md:inline">Logout</span>
                  </a>
                </li>
                <li id="notification-bell-sidebar" style="position:relative;">
                  <div class="flex items-center gap-3 px-3 py-3 rounded-full hover:bg-gray-900 transition text-white font-semibold text-lg w-full cursor-pointer" id="notificationDropdown">
                    <span class="material-icons">notifications</span>
                    <span class="hidden md:inline">Notifications</span>
                    <span id="notification-badge" style="display:none;position:absolute;top:10px;right:10px;background:red;color:white;border-radius:50%;padding:2px 6px;font-size:12px;">0</span>
                  </div>
                  <div id="notification-dropdown" style="display:none;position:absolute;left:60px;top:0;background:#fff;border:1px solid #ccc;width:300px;max-height:400px;overflow-y:auto;z-index:1000;"></div>
                </li>
            </ul>
        </nav>
        <main class="flex-1 container mx-auto px-4">
            <div class="rounded-xl p-6 transition-colors duration-300 shadow">
                {% block content %}{% endblock %}
            </div>
        </main>
    </div>   
    {% block extra_js %}{% endblock %}
</body>
</html>